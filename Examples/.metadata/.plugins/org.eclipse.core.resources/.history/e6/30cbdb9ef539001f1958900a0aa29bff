/*
 * cordinates.c
 *
 *  Created on: Jul 4, 2024
 *      Author: Shreyas Acharya, BHARATI SOFTWARE
 */

#include "cordinates.h"
#include "CST816S.h"
#include "GC9A01A.h"
#include "font.h"
#include <string.h>
#include <stdio.h>

#define COORDINATES_X_POS 40
#define COORDINATES_Y_POS 180
#define COORDINATES_WIDTH 100
#define COORDINATES_HEIGHT 30

void printmsg(uint16_t x, uint16_t y, const char* msg){
	gc9a01a_write_string(x, y, msg , Font_11x18, WHITE, NAVY);
}

void clear_area(uint16_t x, uint16_t y, uint16_t width, uint16_t height, uint16_t color) {
    gc9a01a_rect_fill(x, x + width, y, y + height, color);
}

void tp_cordinates(void) {

	char msg[10];
	struct touch_data data;
	while(1) {
		if(CST816S_data_available()) {
			memcpy(&data, CST816S_get_data(), sizeof(struct touch_data));
			UNUSED(data);
			gc9a01a_rect_fill(30, 80, 160, 18, NAVY);
			gc9a01a_rect_fill(150, 80, 160, 18, NAVY);

			snprintf(msg, sizeof(msg), "X: %d", data.x);
			printmsg(30, 160, (const char*)msg);

			snprintf(msg, sizeof(msg), "Y: %d", data.y);
			printmsg(150, 160, (const char*)msg);

			HAL_Delay(300);

		}
	}
}

void read_sd(void) {
	char msg[10];
	struct touch_data data;
	while(1) {
		if(CST816S_data_available()) {
			int x = data.x;
			int y = data.y;
			if(x>=100 && x<=140 && y>=60 && y<=180) {
				background_fill(NAVY);
				read_sd_card_file();
			}
		}
	}
}


